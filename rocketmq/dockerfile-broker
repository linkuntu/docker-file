FROM docker.io/openjdk:8-jre-alpine

ARG version

# Rocketmq version
ENV ROCKETMQ_VERSION 4.2.0

ENV ROCKETMQ_HOME  /rocketmq/rocketmq-4.2.0
ENV MEMORY "-Xms2g -Xmx2g -Xmn1g"

WORKDIR  ${ROCKETMQ_HOME}
RUN mkdir -p /rocketmq/rocketmq-4.2.0
RUN mkdir -p \
		/rocketmq/commitlog \
	    /rocketmq/store


COPY rocketmq-all-4.2.0-bin-release.zip /rocketmq/rocketmq-4.2.0/
RUN  unzip  rocketmq-all-4.2.0-bin-release.zip



RUN export JAVA_OPT=" -Duser.home=/rocketmq"


COPY set-jvm.sh /rocketmq/rocketmq-4.2.0/docker-entrypoint.sh
RUN chmod +x /rocketmq/rocketmq-4.2.0/docker-entrypoint.sh
ENTRYPOINT ["/rocketmq/rocketmq-4.2.0/docker-entrypoint.sh"]


CMD   sh bin/mqbroker -n namesrv:9876

EXPOSE 10909 10911


